"use strict";(self["webpackChunkmall"]=self["webpackChunkmall"]||[]).push([[217],{7535:function(t,e,n){n.d(e,{E7:function(){return c},LV:function(){return a},MH:function(){return s},NW:function(){return i},QN:function(){return l},hi:function(){return r}});var o=n(4471);const a=t=>o.Z.post("/orders",t),l=t=>o.Z.get(`/orders?status=${t.status}`),s=(t,e)=>o.Z.patch(`/orders/${t}/updateAddr/${e}`),c=(t,e)=>(0,o.Z)({url:`/orders/${t}`,method:"PATCH",data:{status:e}}),i=t=>(0,o.Z)({url:`/orders/selecOrder?orderId=${t}`}),r=t=>o.Z["delete"](`/orders/delete/${t}`)},2520:function(t,e,n){n.d(e,{Z:function(){return f}});var o=n(3396),a=n(7139),l=n.p+"img/tick.82dd6e3a.svg",s=n(4870);const c=t=>((0,o.dD)("data-v-b94a4ab0"),t=t(),(0,o.Cn)(),t),i=c((()=>(0,o._)("img",{src:l,alt:""},null,-1))),r=[i];var u={props:{modelValue:{type:Boolean,default:!0}},emits:["click"],setup(t,{emit:e}){const n=t,l=()=>{e("click")},c=(0,s.iH)(n.modelValue);return(0,o.YP)((()=>n.modelValue),(t=>{c.value=t})),(t,e)=>((0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("div",{class:(0,a.C_)(["icon-selector",{"selector-active":c.value}]),onClick:l},r,2)]))}},d=n(89);const m=(0,d.Z)(u,[["__scopeId","data-v-b94a4ab0"]]);var f=m},6899:function(t,e,n){n.d(e,{Z:function(){return f}});var o=n(3396);const a={class:"nav-bar"},l={class:"nav-left"},s={class:"nav-center"},c=(0,o.Uk)("标题"),i={class:"nav-right"};function r(t,e){return(0,o.wg)(),(0,o.iD)("div",a,[(0,o._)("div",l,[(0,o.WI)(t.$slots,"left",{},void 0,!0)]),(0,o._)("div",s,[(0,o.WI)(t.$slots,"center",{},(()=>[c]),!0)]),(0,o._)("div",i,[(0,o.WI)(t.$slots,"right",{},void 0,!0)])])}var u=n(89);const d={},m=(0,u.Z)(d,[["render",r],["__scopeId","data-v-6887fa4f"]]);var f=m},2131:function(t,e,n){n.d(e,{Z:function(){return S}});n(6699);var o=n(3396),a=n(4870),l=n(7139),s=n(65),c=n(678);const i={class:"tabbar"};function r(t,e){return(0,o.wg)(),(0,o.iD)("div",i,[(0,o.WI)(t.$slots,"default",{},void 0,!0)])}var u=n(89);const d={},m=(0,u.Z)(d,[["render",r],["__scopeId","data-v-3e341c93"]]);var f=m,v=n(9242);const p={class:"item-icon"},g={class:"item-active-icon"};var w={props:{link:{type:String,required:!0}},setup(t){const e=t,n=(0,c.tv)(),s=()=>{n.replace(e.link)},i=(0,c.yj)(),r=(0,o.Fl)((()=>-1!==i.path.indexOf(e.link)));return(t,e)=>((0,o.wg)(),(0,o.iD)("div",{class:"tab-bar-item",onClick:s},[(0,o.wy)((0,o._)("div",p,[(0,o.WI)(t.$slots,"icon")],512),[[v.F8,!(0,a.SU)(r)]]),(0,o.wy)((0,o._)("div",g,[(0,o.WI)(t.$slots,"active-icon")],512),[[v.F8,(0,a.SU)(r)]]),(0,o._)("div",{class:(0,l.C_)(["item-text",(0,a.SU)(r)?"active":""])},[(0,o.WI)(t.$slots,"text")],2)]))}};const h=w;var _=h;const b=["src"],C=["src"],y=["src"],k=["src"];var I={setup(t){const e=(0,a.qj)([{id:1,icon:n(9537),activeIcon:n(996),text:"首页",to:"home"},{id:2,icon:n(4166),activeIcon:n(1488),text:"分类",to:"category"},{id:3,icon:n(782),activeIcon:n(7870),text:"购物车",to:"cart"},{id:4,icon:n(8561),activeIcon:n(5120),text:"我的",to:"account"}]),{state:i,dispatch:r,getters:u}=(0,s.oR)(),d=(0,c.yj)();(0,o.bv)((async()=>{const t=u.token,e=d.path;t&&!["/home","/category"].includes(e)&&r("cart/getCartList")}));const m=(0,o.Fl)((()=>i.cart.cartCount));return(t,n)=>{const s=(0,o.up)("van-badge");return(0,o.wg)(),(0,o.j4)((0,a.SU)(f),null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)((0,a.SU)(e),(t=>((0,o.wg)(),(0,o.j4)((0,a.SU)(_),{key:t.id,link:t.to},{icon:(0,o.w5)((()=>[3===t.id?((0,o.wg)(),(0,o.j4)(s,{key:0,content:(0,a.SU)(m)?(0,a.SU)(m):"",max:"99"},{default:(0,o.w5)((()=>[(0,o._)("img",{src:t.icon,alt:""},null,8,b)])),_:2},1032,["content"])):((0,o.wg)(),(0,o.iD)("img",{key:1,src:t.icon,alt:""},null,8,C))])),"active-icon":(0,o.w5)((()=>[3===t.id?((0,o.wg)(),(0,o.j4)(s,{key:0,content:(0,a.SU)(m)?(0,a.SU)(m):"",max:"99"},{default:(0,o.w5)((()=>[(0,o._)("img",{src:t.activeIcon,alt:""},null,8,y)])),_:2},1032,["content"])):((0,o.wg)(),(0,o.iD)("img",{key:1,src:t.activeIcon,alt:""},null,8,k))])),text:(0,o.w5)((()=>[(0,o._)("span",null,(0,l.zw)(t.text),1)])),_:2},1032,["link"])))),128))])),_:1})}}};const B=I;var S=B},2574:function(t,e,n){n.r(e),n.d(e,{default:function(){return nt}});var o=n(3396),a=n(4870),l=n(678),s=n(65),c=n(2131),i=(n(1643),n(1514)),r=(n(767),n(7619)),u=n(7139),d=n(2520),m=n(6624),f=n(7535);const v=t=>((0,o.dD)("data-v-390230dc"),t=t(),(0,o.Cn)(),t),p={class:"tabBar"},g={class:"tabBarLeft"},w=v((()=>(0,o._)("span",null,"全选",-1))),h={key:0,class:"selectAll"},_=(0,o.Uk)(" 合计:"),b={class:"totalPrice"},C={class:"tabBarRight"};var y={props:{isEdit:Boolean},setup(t){const{state:e,commit:n,getters:c}=(0,s.oR)(),v=(0,o.Fl)((()=>Object.values(e.cart.shopCart).filter((t=>t.checked)).length)),y=(0,o.Fl)((()=>{let t=0;return Object.values(e.cart.shopCart).forEach(((e,n)=>{e.checked&&(t+=e.num*Number(e.price))})),"￥"+Number(t).toFixed(2)})),k=(0,o.Fl)((()=>Object.values(e.cart.shopCart).every((t=>t.checked)))),I=async t=>{const e=await(0,m.td)({flag:!t});e.success&&n("cart/SELECTED_ALL_GOODS",{isSelected:t})},B=async()=>{n("cart/INIT_SHOP_CART");const t=[],o=[];e.cart.selectArr.forEach((e=>{t.push(e.cartId),o.push(e.goodsId)})),0!==t.length?i.Z.confirm({message:`确认将这${t.length}个宝贝删除?`}).then((async()=>{const e=await(0,m.U5)(t);e.success&&((0,r.Z)(e.msg),n("cart/REMOVE_CART",{goodsId:o}))})).catch((()=>{})):(0,r.Z)("请选择要删除的商品")},S=(0,l.tv)(),D=async()=>{if(n("cart/INIT_SHOP_CART"),v.value>0){const t=await(0,f.LV)({address_id:1,goods_info:JSON.stringify(e.cart.selectArr),total:c["cart/totalPrice"].toString()});t.success&&S.push({path:"/order",query:{orderId:t.data.id}})}else(0,r.Z)("请先选择商品后结算")};return(e,n)=>((0,o.wg)(),(0,o.iD)("div",p,[(0,o._)("div",g,[(0,o.Wm)((0,a.SU)(d.Z),{modelValue:(0,a.SU)(k),"onUpdate:modelValue":n[0]||(n[0]=t=>(0,a.dq)(k)?k.value=t:null),class:"select-all",onClick:n[1]||(n[1]=t=>I((0,a.SU)(k)))},null,8,["modelValue"]),w,t.isEdit?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",h,[_,(0,o._)("span",b,(0,u.zw)((0,a.SU)(y)),1)]))]),(0,o._)("div",C,[t.isEdit?((0,o.wg)(),(0,o.iD)("button",{key:1,class:"pay",onClick:B},"删除("+(0,u.zw)((0,a.SU)(v))+")",1)):((0,o.wg)(),(0,o.iD)("button",{key:0,class:"pay",onClick:D},"去结算("+(0,u.zw)((0,a.SU)(v))+")",1))])]))}},k=n(89);const I=(0,k.Z)(y,[["__scopeId","data-v-390230dc"]]);var B=I;const S={class:"shop-container"},D={class:"content"},x={class:"selector"},O={class:"img-area"},U=["src"],Z={class:"info-area"},W={class:"title-price"},V={class:"title"},E={class:"price"},T={class:"count-remove-content"},j={class:"count-remove"};var A={props:{itemInfo:{type:Object}},setup(t){const{commit:e}=(0,s.oR)(),n=async t=>{const n=!t.checked,o=await(0,m.xu)(t.cartId,{selected:n});o.success&&e("cart/SELECTED_SINGLE_GOODS",{goodsId:t.goodsId})},l=async t=>{t.num+=1;const n=await(0,m.xu)(t.cartId,{number:t.num});if(n.success){const n={};n.cartId=t.cartId,n.goodsId=t.goodsId,n.name=t.name,n.small_image=t.small_image,n.price=t.price,e("cart/ADD_GOODS",n)}},c=async t=>{t.num-=1;const n=await(0,m.xu)(t.cartId,{number:t.num});n.success&&e("cart/REDUCE_CART",{goodsId:t.goodsId})},f=t=>{i.Z.confirm({message:"确认将这1个宝贝删除?"}).then((async()=>{const n=await(0,m.U5)([t.cartId]);n.success&&((0,r.Z)({message:n.msg,duration:1e3}),e("cart/REMOVE_CART",{goodsId:t.goodsId}))})).catch((()=>{}))};return(e,s)=>{const i=(0,o.up)("van-stepper");return(0,o.wg)(),(0,o.iD)("div",S,[(0,o._)("div",D,[(0,o._)("div",x,[(0,o.Wm)((0,a.SU)(d.Z),{modelValue:t.itemInfo.checked,"onUpdate:modelValue":s[0]||(s[0]=e=>t.itemInfo.checked=e),onClick:s[1]||(s[1]=e=>n(t.itemInfo))},null,8,["modelValue"])]),(0,o._)("div",O,[(0,o._)("img",{src:t.itemInfo.small_image,alt:""},null,8,U)]),(0,o._)("div",Z,[(0,o._)("div",W,[(0,o._)("p",V,(0,u.zw)(t.itemInfo.name),1),(0,o._)("span",E,"¥"+(0,u.zw)(t.itemInfo.price),1)]),(0,o._)("div",T,[(0,o._)("div",j,[(0,o._)("div",null,[(0,o.Wm)(i,{modelValue:t.itemInfo.num,"onUpdate:modelValue":s[2]||(s[2]=e=>t.itemInfo.num=e),integer:"",max:"20","disable-input":"",onPlus:s[3]||(s[3]=e=>l(t.itemInfo)),onMinus:s[4]||(s[4]=e=>c(t.itemInfo))},null,8,["modelValue"])]),(0,o._)("i",{class:"iconfont icon-ashbin",onClick:s[5]||(s[5]=e=>f(t.itemInfo))})])])])])])}}};const H=(0,k.Z)(A,[["__scopeId","data-v-fad1c8e0"]]);var $=H,F={props:{cartlistData:{type:Object}},setup(t){return(e,n)=>((0,o.wg)(),(0,o.iD)("div",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.cartlistData,(t=>((0,o.wg)(),(0,o.j4)((0,a.SU)($),{key:t.cartId,"item-info":t},null,8,["item-info"])))),128))]))}};const N=F;var P=N,R=n(6899);const z=t=>((0,o.dD)("data-v-6f07c325"),t=t(),(0,o.Cn)(),t),L=z((()=>(0,o._)("span",null,"购物车",-1)));var G={props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(t,{emit:e}){const n=t,l=()=>{e("update:modelValue",!n.modelValue)};return(e,n)=>((0,o.wg)(),(0,o.j4)((0,a.SU)(R.Z),{class:"border-1px"},{center:(0,o.w5)((()=>[L])),right:(0,o.w5)((()=>[(0,o._)("span",{onClick:l},(0,u.zw)(t.modelValue?"完成":"编辑"),1)])),_:1}))}};const q=(0,k.Z)(G,[["__scopeId","data-v-6f07c325"]]);var M=q;const J=t=>((0,o.dD)("data-v-3d8f1146"),t=t(),(0,o.Cn)(),t),Y={class:"cart-container"},K={key:0},Q={key:1,class:"cartEmpty"},X=J((()=>(0,o._)("h2",null,"购物车空荡荡的, 去首页逛逛吧",-1)));var tt={setup(t){const{state:e}=(0,s.oR)(),n=(0,l.tv)(),i=()=>n.push("/home"),r=(0,o.Fl)((()=>e.cart.shopCart)),u=(0,o.Fl)((()=>Object.getOwnPropertyNames(e.cart.shopCart).length)),d=(0,a.iH)(!1);return(t,e)=>((0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)((0,a.SU)(M),{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t)},null,8,["modelValue"]),(0,o._)("div",Y,[0!==(0,a.SU)(u)?((0,o.wg)(),(0,o.iD)("div",K,[(0,o.Wm)((0,a.SU)(P),{"cartlist-data":(0,a.SU)(r)},null,8,["cartlist-data"])])):((0,o.wg)(),(0,o.iD)("div",Q,[X,(0,o._)("button",{class:"goShopping",onClick:i},"去逛逛")]))]),(0,o.Wm)((0,a.SU)(B),{"is-edit":d.value},null,8,["is-edit"]),(0,o.Wm)((0,a.SU)(c.Z))],64))}};const et=(0,k.Z)(tt,[["__scopeId","data-v-3d8f1146"]]);var nt=et},782:function(t,e,n){t.exports=n.p+"img/cart.883aded3.svg"},7870:function(t,e,n){t.exports=n.p+"img/cart_active.a5fff7f8.svg"},4166:function(t,e,n){t.exports=n.p+"img/category.cf162e2e.svg"},1488:function(t,e,n){t.exports=n.p+"img/category_active.fa49b3ae.svg"},9537:function(t,e,n){t.exports=n.p+"img/home.0be7de05.svg"},996:function(t,e,n){t.exports=n.p+"img/home_active.f910b8a8.svg"},8561:function(t,e,n){t.exports=n.p+"img/profile.8be0b7e0.svg"},5120:function(t,e,n){t.exports=n.p+"img/profile_active.2f1077b7.svg"},1514:function(t,e,n){n.d(e,{Z:function(){return N}});var o=n(3396),a=n(2220),l=n(1404),s=n(7548),c=n(4870),i=n(9242),r=n(610),u=n(5323),d=n(9951),m=n(6491),f=n(5322),v=n(8332),p=n(4877),g=n(6305),w=n(9545),h=n(253);const[_,b]=(0,r["do"])("action-bar"),C=Symbol(_),y={safeAreaInsetBottom:u.J5};var k=(0,o.aZ)({name:_,props:y,setup(t,{slots:e}){const{linkChildren:n}=(0,h.$E)(C);return n(),()=>{var n;return(0,o.Wm)("div",{class:[b(),{"van-safe-area-bottom":t.safeAreaInsetBottom}]},[null==(n=e.default)?void 0:n.call(e)])}}});const I=(0,l.n)(k);var B=n(3444),S=n(6014);const[D,x]=(0,r["do"])("action-bar-button"),O=(0,a.l7)({},S.g2,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var U=(0,o.aZ)({name:D,props:O,setup(t,{slots:e}){const n=(0,S.yj)(),{parent:a,index:l}=(0,h.NB)(C),s=(0,o.Fl)((()=>{if(a){const t=a.children[l.value-1];return!(t&&"isButton"in t)}})),c=(0,o.Fl)((()=>{if(a){const t=a.children[l.value+1];return!(t&&"isButton"in t)}}));return(0,B.F)({isButton:!0}),()=>{const{type:a,icon:l,text:i,color:r,loading:u,disabled:d}=t;return(0,o.Wm)(w.z,{class:x([a,{last:c.value,first:s.value}]),size:"large",type:a,icon:l,color:r,loading:u,disabled:d,onClick:n},{default:()=>[e.default?e.default():i]})}}});const Z=(0,l.n)(U);const[W,V,E]=(0,r["do"])("dialog"),T=(0,a.l7)({},p.W,{title:String,theme:String,width:u.Or,message:[String,Function],callback:Function,allowHtml:Boolean,className:u.Vg,transition:(0,u.SQ)("van-dialog-bounce"),messageAlign:String,closeOnPopstate:u.J5,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:u.J5,closeOnClickOverlay:Boolean}),j=[...p.m,"transition","closeOnPopstate"];var A=(0,o.aZ)({name:W,props:T,emits:["confirm","cancel","keydown","update:show"],setup(t,{emit:e,slots:n}){const l=(0,c.iH)(),s=(0,c.qj)({confirm:!1,cancel:!1}),r=t=>e("update:show",t),u=e=>{var n;r(!1),null==(n=t.callback)||n.call(t,e)},p=n=>()=>{t.show&&(e(n),t.beforeClose?(s[n]=!0,(0,d.I)(t.beforeClose,{args:[n],done(){u(n),s[n]=!1},canceled(){s[n]=!1}})):u(n))},h=p("cancel"),_=p("confirm"),b=(0,i.D2)((n=>{var o,s;if(n.target!==(null==(s=null==(o=l.value)?void 0:o.popupRef)?void 0:s.value))return;const c={Enter:t.showConfirmButton?_:a.ZT,Escape:t.showCancelButton?h:a.ZT};c[n.key](),e("keydown",n)}),["enter","esc"]),C=()=>{const e=n.title?n.title():t.title;if(e)return(0,o.Wm)("div",{class:V("header",{isolated:!t.message&&!n.default})},[e])},y=e=>{const{message:n,allowHtml:a,messageAlign:l}=t,s=V("message",{"has-title":e,[l]:l}),c=(0,m.mf)(n)?n():n;return a&&"string"===typeof c?(0,o.Wm)("div",{class:s,innerHTML:c},null):(0,o.Wm)("div",{class:s},[c])},k=()=>{if(n.default)return(0,o.Wm)("div",{class:V("content")},[n.default()]);const{title:e,message:a,allowHtml:l}=t;if(a){const t=!(!e&&!n.title);return(0,o.Wm)("div",{key:l?1:0,class:V("content",{isolated:!t})},[y(t)])}},B=()=>(0,o.Wm)("div",{class:[f.k7,V("footer")]},[t.showCancelButton&&(0,o.Wm)(w.z,{size:"large",text:t.cancelButtonText||E("cancel"),class:V("cancel"),style:{color:t.cancelButtonColor},loading:s.cancel,disabled:t.cancelButtonDisabled,onClick:h},null),t.showConfirmButton&&(0,o.Wm)(w.z,{size:"large",text:t.confirmButtonText||E("confirm"),class:[V("confirm"),{[f.a8]:t.showCancelButton}],style:{color:t.confirmButtonColor},loading:s.confirm,disabled:t.confirmButtonDisabled,onClick:_},null)]),S=()=>(0,o.Wm)(I,{class:V("footer")},{default:()=>[t.showCancelButton&&(0,o.Wm)(Z,{type:"warning",text:t.cancelButtonText||E("cancel"),class:V("cancel"),color:t.cancelButtonColor,loading:s.cancel,disabled:t.cancelButtonDisabled,onClick:h},null),t.showConfirmButton&&(0,o.Wm)(Z,{type:"danger",text:t.confirmButtonText||E("confirm"),class:V("confirm"),color:t.confirmButtonColor,loading:s.confirm,disabled:t.confirmButtonDisabled,onClick:_},null)]}),D=()=>n.footer?n.footer():"round-button"===t.theme?S():B();return()=>{const{width:e,title:n,theme:s,message:c,className:i}=t;return(0,o.Wm)(g.G,(0,o.dG)({ref:l,role:"dialog",class:[V([s]),i],style:{width:(0,v.Nn)(e)},tabindex:0,"aria-labelledby":n||c,onKeydown:b,"onUpdate:show":r},(0,a.ei)(t,j)),{default:()=>[C(),k(),D()]})}}});let H;function $(){const t={setup(){const{state:t,toggle:e}=(0,s.o)();return()=>(0,o.Wm)(A,(0,o.dG)(t,{"onUpdate:show":e}),null)}};({instance:H}=(0,s.H)(t))}function F(t){return a._f?new Promise(((e,n)=>{H||$(),H.open((0,a.l7)({},F.currentOptions,t,{callback:t=>{("confirm"===t?e:n)(t)}}))})):Promise.resolve()}F.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1},F.currentOptions=(0,a.l7)({},F.defaultOptions),F.alert=F,F.confirm=t=>F((0,a.l7)({showCancelButton:!0},t)),F.close=()=>{H&&H.toggle(!1)},F.setDefaultOptions=t=>{(0,a.l7)(F.currentOptions,t)},F.resetDefaultOptions=()=>{F.currentOptions=(0,a.l7)({},F.defaultOptions)},F.Component=(0,l.n)(A),F.install=t=>{t.use(F.Component),t.config.globalProperties.$dialog=F};var N=F},1643:function(t,e,n){n(1958),n(368),n(6742),n(2939),n(1452),n(6196),n(2666)}}]);
//# sourceMappingURL=217.31661156.js.map